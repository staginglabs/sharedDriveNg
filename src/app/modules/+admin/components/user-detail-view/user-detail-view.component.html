<section class="p-5 d-flex w-100 flex-column">
  <app-loader-small [status]="!activeUser"></app-loader-small>
  <ng-container *ngIf="activeUser">
    <div class="">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-transparent">
          <li class="breadcrumb-item parentBread">
            <a href="javascript:void(0)">
              <span class="userIcon pr-2">
                <svg width="20" height="14" viewBox="0 0 20 14" fill="none"  xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.1458 7.69333C13.8958 7.69333 14.7292 7.80889 15.6458 8.04C16.6597 8.31445 17.4861 8.66833 18.125 9.10167C18.875 9.62167 19.25 10.2067 19.25 10.8567V13.11H14.0417V10.8567C14.0417 9.62888 13.4722 8.58889 12.3333 7.73667C12.5278 7.70778 12.7986 7.69333 13.1458 7.69333ZM6.22917 7.69333C6.97917 7.69333 7.80555 7.80889 8.70833 8.04C9.72223 8.31445 10.5417 8.66833 11.1667 9.10167C11.9167 9.62167 12.2917 10.2067 12.2917 10.8567V13.11H0.125V10.8567C0.125 10.2067 0.499996 9.62167 1.25 9.10167C1.88889 8.66833 2.71527 8.31445 3.72917 8.04C4.64584 7.80889 5.47916 7.69333 6.22917 7.69333ZM6.22917 5.91667C5.77083 5.91667 5.34028 5.79389 4.9375 5.54833C4.53472 5.30278 4.21528 4.97056 3.97917 4.55167C3.74305 4.13278 3.625 3.685 3.625 3.20833C3.625 2.73166 3.74305 2.28389 3.97917 1.865C4.21528 1.44611 4.53472 1.11389 4.9375 0.868333C5.34028 0.622777 5.77083 0.5 6.22917 0.5C6.6875 0.5 7.11458 0.622777 7.51042 0.868333C7.90625 1.11389 8.21875 1.4425 8.44792 1.85417C8.67708 2.26584 8.79167 2.71722 8.79167 3.20833C8.79167 3.69945 8.67708 4.15083 8.44792 4.5625C8.21875 4.97417 7.90625 5.30278 7.51042 5.54833C7.11458 5.79389 6.6875 5.91667 6.22917 5.91667ZM13.1458 5.91667C12.6875 5.91667 12.2569 5.79389 11.8542 5.54833C11.4514 5.30278 11.1319 4.97056 10.8958 4.55167C10.6597 4.13278 10.5417 3.685 10.5417 3.20833C10.5417 2.73166 10.6597 2.28389 10.8958 1.865C11.1319 1.44611 11.4514 1.11389 11.8542 0.868333C12.2569 0.622777 12.6875 0.5 13.1458 0.5C13.6042 0.5 14.0347 0.622777 14.4375 0.868333C14.8403 1.11389 15.1597 1.44611 15.3958 1.865C15.6319 2.28389 15.75 2.73166 15.75 3.20833C15.75 3.685 15.6319 4.13278 15.3958 4.55167C15.1597 4.97056 14.8403 5.30278 14.4375 5.54833C14.0347 5.79389 13.6042 5.91667 13.1458 5.91667Z" fill="#005073"/></svg>
              </span>
              <span class="text-uppercase">{{activeUser.displayName}}</span>
            </a>
          </li>
          <li class="breadcrumb-item childBread">
            <a href="javascript:void(0)" [routerLink]="['/admin/drive/external/dashboard']" >
              Drivelop
            </a>
          </li>
          <li class="breadcrumb-item childBread active" aria-current="page">
            <ng-container *ngIf="activeUser.isOffline">{{ 'cmn.offline' | translate }}</ng-container>
            <ng-container *ngIf="!activeUser.isOffline">{{ 'cmn.online' | translate }}</ng-container>
          </li>
        </ol>
      </nav>
    </div>
    <div class="form-group custom d-flex">
      <div class="flex-grow-1">
        <input class="form-control" placeholder="{{ 'placeholder.file' | translate }}" type="search" name="searchString" [(ngModel)]="searchString" />
      </div>
      <div class="ml-3">
        <button class="btn btn-primary" (click)="openModal()">+ {{ 'upload.folderCreate' | translate }}</button>
      </div>
    </div>

    <section class="d-flex flex-wrap fldrWrap">
      <div class="card" *ngFor="let item of (foldersList$ | async)">
        <div class="card-body-sec">
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-light">
              <ng-container *ngTemplateOutlet="fileIconTemp"></ng-container>
            </button>
            <ng-container *ngTemplateOutlet="ellipTemp; context: {color: 'blue', item: item}"></ng-container>
          </div>
          <h5>
            <a routerLink="drive/{{item}}">{{item}}</a>
          </h5>
        </div>
      </div>
      <!-- end loop -->
    </section>
    <!-- end folders -->

    <!-- table start -->
    <section class="d-flex w-100 flex-column" *ngIf="activeUser">
      <app-file-list-view [activeUser]="activeUser" [userId]="activeUser.id" [searchString]="searchString" [fileList]="filesList$ | async"></app-file-list-view>
    </section>
    <!-- end table -->

  </ng-container>
</section>


<ng-template #fileIconTemp>
<svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M0.763184 2.45783H1.99429V10.6679H10.7622V11.8207H1.99429C1.65398 11.8207 1.36372 11.7082 1.12351 11.4833C0.88329 11.2584 0.763184 10.9866 0.763184 10.6679V2.45783ZM6.39324 5.97242L4.51656 8.30611H12.0233L9.50104 5.39603L7.65438 7.56102L6.39324 5.97242ZM13.2544 8.30611C13.2544 8.62477 13.1343 8.90124 12.8941 9.13555C12.6539 9.36986 12.3636 9.48701 12.0233 9.48701H4.51656C4.17625 9.48701 3.88099 9.36986 3.63076 9.13555C3.38054 8.90124 3.25542 8.62477 3.25542 8.30611V1.27693C3.25542 0.958273 3.38054 0.686481 3.63076 0.461546C3.88099 0.236611 4.17625 0.124146 4.51656 0.124146H12.0233C12.3636 0.124146 12.6539 0.236611 12.8941 0.461546C13.1343 0.686481 13.2544 0.958273 13.2544 1.27693V8.30611Z" fill="#005073"/>
  </svg>
</ng-template>

<ng-template #ellipTemp let-color="color" let-item="item">
  <div ngbDropdown class="tdEllipsisIcon w-auto" placement="bottom-left">
    <a ngbDropdownToggle href="javascript:void(0);" class="card-dot ellpDots {{color}}">
      <svg width="5" height="4" viewBox="0 0 5 4" fill="none" xmlns="http://www.w3.org/2000/svg">
        <ellipse cx="2.52478" cy="1.92069" rx="1.9242" ry="1.87931" fill="none" />
      </svg>
      <svg width="5" height="4" viewBox="0 0 5 4" fill="none" xmlns="http://www.w3.org/2000/svg">
        <ellipse cx="2.52478" cy="1.92069" rx="1.9242" ry="1.87931" fill="none" />
      </svg>
      <svg width="5" height="4" viewBox="0 0 5 4" fill="none" xmlns="http://www.w3.org/2000/svg">
        <ellipse cx="2.52478" cy="1.92069" rx="1.9242" ry="1.87931" fill="none" />
      </svg>
    </a>
    <div ngbDropdownMenu>
      <!-- <button ngbDropdownItem (click)="downloadFolder(item)"><span class="drop-icon pr-2"><svg width="12" height="15" viewBox="0 0 12 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M-1.09278e-06 12.5L11.64 12.5L11.64 14.18L-1.23965e-06 14.18L-1.09278e-06 12.5ZM8.32 7.27357e-07L8.32 5L11.64 5L5.82 10.82L-4.37114e-07 5L3.32 5L3.32 2.90244e-07L8.32 7.27357e-07Z" fill="#C4C4C4" /></svg></span>{{ 'btn.download' | translate }}</button> -->
      <button ngbDropdownItem  (click)="deleteFolder(item)"><span class="drop-icon pr-2"><svg width="17" height="18" viewBox="0 0 17 18"
            fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M11.125 0.75V2.5H16.375V4.25H0.625V2.5H5.875V0.75H11.125ZM2.375 15.625C2.375 16.5901 3.15987 17.375 4.125 17.375H12.875C13.8401 17.375 14.625 16.5901 14.625 15.625V5.125H2.375V15.625ZM4.125 6.875H12.875L12.8759 15.625H4.125V6.875ZM5.875 8.625H7.625V13.875H5.875V8.625ZM11.125 8.625H9.375V13.875H11.125V8.625Z"
              fill="#C4C4C4" />
          </svg></span>{{ 'btn.delete' | translate }}</button>
    </div>
  </div>
</ng-template>
